# Requirements Archive: v1.0 City Chatbot Backend PoC

**Archived:** 2026-01-21
**Status:** ✅ SHIPPED

This is the archived requirements specification for v1.0.
For current requirements, see `.planning/REQUIREMENTS.md` (created for next milestone).

---

# Requirements: Stream Gen UI — City Chatbot Backend

**Defined:** 2026-01-20
**Core Value:** The chatbot returns accurate, well-formatted responses with Contact cards and Calendar events rendered as rich UI components when relevant.

## v1 Requirements

Requirements for initial PoC release. Each maps to roadmap phases.

### Project Structure

- [x] **STRUCT-01**: Frontend files moved to frontend/ directory
- [x] **STRUCT-02**: Frontend builds and runs from frontend/ directory
- [x] **STRUCT-03**: All source code paths updated for new structure
- [x] **STRUCT-04**: All documentation paths updated for new structure
- [x] **STRUCT-05**: Backend created in backend/ directory with FastAPI

### RAG & Retrieval

- [x] **RAG-01**: Markdown files chunked for embedding with appropriate strategy
- [x] **RAG-02**: Hybrid retrieval combining keyword and semantic search
- [x] **RAG-03**: Vector store populated with city contacts, events, and general info
- [x] **RAG-04**: Retrieval returns source metadata (document title, chunk reference)

### ReAct Agent

- [x] **AGENT-01**: ReAct agent implements Thought-Action-Observation cycle
- [x] **AGENT-02**: Agent uses RAG as a tool and decides when to invoke it
- [x] **AGENT-03**: Agent has max iteration limit (5) to prevent infinite loops
- [x] **AGENT-04**: Agent uses Mistral LLM for reasoning

### Structured Output

- [x] **OUTPUT-01**: Agent outputs Contact entities matching ContactCardProps interface
- [x] **OUTPUT-02**: Agent outputs CalendarEvent entities matching CalendarEventProps interface
- [x] **OUTPUT-03**: Response format is consistent and predictable for frontend parsing

### Streaming & API

- [x] **STREAM-01**: /api/chat endpoint accepts POST with messages array
- [x] **STREAM-02**: Response streams via SSE (Server-Sent Events)
- [x] **STREAM-03**: Streaming compatible with existing useChat hook transport
- [x] **STREAM-04**: Inline citations reference source documents in response

### Conversation

- [x] **CONV-01**: Message history tracked across conversation turns
- [x] **CONV-02**: Agent uses conversation context for follow-up questions

### Error Handling & Observability

- [x] **ERR-01**: Tool call failures handled gracefully with user-friendly messages
- [x] **ERR-02**: Request timeouts prevent hung requests (configurable, default 30s)
- [x] **ERR-03**: Agent traces logged via LangSmith or Langfuse

### Knowledge Base

- [x] **KB-01**: Fictional city contacts created in markdown format
- [x] **KB-02**: Fictional city events created in markdown format
- [x] **KB-03**: General city information (hours, services) in markdown format

## Traceability

Which phases cover which requirements.

| Requirement | Phase | Status |
|-------------|-------|--------|
| STRUCT-01 | Phase 1 | Complete |
| STRUCT-02 | Phase 1 | Complete |
| STRUCT-03 | Phase 1 | Complete |
| STRUCT-04 | Phase 1 | Complete |
| STRUCT-05 | Phase 2 | Complete |
| RAG-01 | Phase 2 | Complete |
| RAG-02 | Phase 2 | Complete |
| RAG-03 | Phase 2 | Complete |
| RAG-04 | Phase 2 | Complete |
| KB-01 | Phase 2 | Complete |
| KB-02 | Phase 2 | Complete |
| KB-03 | Phase 2 | Complete |
| AGENT-01 | Phase 3 | Complete |
| AGENT-02 | Phase 3 | Complete |
| AGENT-03 | Phase 3 | Complete |
| AGENT-04 | Phase 3 | Complete |
| OUTPUT-01 | Phase 3 | Complete |
| OUTPUT-02 | Phase 3 | Complete |
| OUTPUT-03 | Phase 3 | Complete |
| STREAM-01 | Phase 3 | Complete |
| STREAM-02 | Phase 3 | Complete |
| STREAM-03 | Phase 3 | Complete |
| STREAM-04 | Phase 3 | Complete |
| CONV-01 | Phase 3 | Complete |
| CONV-02 | Phase 3 | Complete |
| ERR-01 | Phase 3 | Complete |
| ERR-02 | Phase 3 | Complete |
| ERR-03 | Phase 3 | Complete |

**Coverage:**
- v1 requirements: 28 total
- Mapped to phases: 28
- Completed: 28 ✓

---

## Milestone Summary

**Shipped:** 28 of 28 v1 requirements
**Adjusted:** None — all requirements implemented as specified
**Dropped:** None

---
*Archived: 2026-01-21 as part of v1.0 milestone completion*
