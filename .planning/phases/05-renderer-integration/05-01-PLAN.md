---
phase: 05-renderer-integration
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - frontend/package.json
  - frontend/app/layout.tsx
  - frontend/components/shared/StopButton.tsx
  - frontend/components/shared/ComponentSkeleton.tsx
  - frontend/app/globals.css
autonomous: true

must_haves:
  truths:
    - "Sonner toast library is installed and configured"
    - "StopButton component renders a clickable stop icon"
    - "ComponentSkeleton shows animated placeholder for contact and calendar"
    - "Fade transition CSS is available for component reveal"
  artifacts:
    - path: "frontend/components/shared/StopButton.tsx"
      provides: "Stop streaming button component"
      exports: ["StopButton"]
    - path: "frontend/components/shared/ComponentSkeleton.tsx"
      provides: "Skeleton loaders for incomplete blocks"
      exports: ["ComponentSkeleton"]
    - path: "frontend/app/layout.tsx"
      provides: "Sonner Toaster provider"
      contains: "Toaster"
  key_links:
    - from: "frontend/app/layout.tsx"
      to: "sonner"
      via: "Toaster import"
      pattern: "import.*Toaster.*sonner"
---

<objective>
Create shared infrastructure for renderer integration: toast notifications, stop button, and skeleton loaders.

Purpose: Both llm-ui and Streamdown pages need these shared components for error handling (toasts), stream abortion (stop button), and transient markup hiding (skeletons). Building them first enables parallel integration in subsequent plans.

Output: Shared components ready for use by page integrations.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-renderer-integration/05-CONTEXT.md
@.planning/phases/05-renderer-integration/05-RESEARCH.md

# Reference existing components
@frontend/components/shared/TypingIndicator.tsx
@frontend/app/layout.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install sonner and configure Toaster</name>
  <files>frontend/package.json, frontend/app/layout.tsx</files>
  <action>
1. Install sonner: `npm install sonner`

2. Update layout.tsx to add Toaster provider:
   - Import `Toaster` from 'sonner'
   - Add `<Toaster position="bottom-right" richColors closeButton />` inside body, after ViewRawProvider
   - This enables toast notifications app-wide

No other configuration needed - sonner works out of the box.
  </action>
  <verify>
- `npm ls sonner` shows installed version
- layout.tsx includes Toaster import and component
- No TypeScript errors: `npx tsc --noEmit`
  </verify>
  <done>Sonner installed, Toaster configured in layout.tsx</done>
</task>

<task type="auto">
  <name>Task 2: Create StopButton and ComponentSkeleton components</name>
  <files>frontend/components/shared/StopButton.tsx, frontend/components/shared/ComponentSkeleton.tsx, frontend/app/globals.css</files>
  <action>
1. Create StopButton.tsx:
```typescript
'use client';

import type { ReactElement } from 'react';
import { StopCircle } from 'lucide-react';
import { cn } from '@/lib/utils';

interface StopButtonProps {
  onClick: () => void;
  className?: string;
}

export function StopButton({ onClick, className }: StopButtonProps): ReactElement {
  return (
    <button
      onClick={onClick}
      className={cn(
        'flex items-center gap-2 px-3 py-1.5 text-sm',
        'text-gray-600 hover:text-gray-900 hover:bg-gray-100',
        'rounded-lg transition-colors',
        'focus:outline-none focus:ring-2 focus:ring-gray-400',
        className
      )}
      aria-label="Stop generating"
    >
      <StopCircle className="h-4 w-4" aria-hidden="true" />
      Stop
    </button>
  );
}
```

2. Create ComponentSkeleton.tsx:
```typescript
'use client';

import type { ReactElement } from 'react';
import { cn } from '@/lib/utils';

interface ComponentSkeletonProps {
  type: 'contact' | 'calendar';
  className?: string;
}

export function ComponentSkeleton({ type, className }: ComponentSkeletonProps): ReactElement {
  return (
    <div
      className={cn(
        'animate-pulse rounded-lg border border-gray-200 bg-white p-4',
        'transition-opacity duration-150',
        className
      )}
      aria-label={`Loading ${type}...`}
      role="status"
    >
      <div className="flex gap-4">
        {type === 'contact' && (
          <>
            <div className="h-12 w-12 rounded-full bg-gray-200" />
            <div className="flex-1 space-y-2">
              <div className="h-4 w-32 bg-gray-200 rounded" />
              <div className="h-3 w-48 bg-gray-200 rounded" />
            </div>
          </>
        )}
        {type === 'calendar' && (
          <>
            <div className="h-12 w-12 rounded bg-gray-200" />
            <div className="flex-1 space-y-2">
              <div className="h-4 w-40 bg-gray-200 rounded" />
              <div className="h-3 w-24 bg-gray-200 rounded" />
            </div>
          </>
        )}
      </div>
    </div>
  );
}
```

3. Add fade-in animation to globals.css (after existing styles):
```css
/* Component fade-in animation for skeleton -> component transition */
.component-fade-in {
  animation: componentFadeIn 150ms ease-out;
}

@keyframes componentFadeIn {
  from {
    opacity: 0;
    transform: translateY(4px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}
```
  </action>
  <verify>
- Files exist at expected paths
- No TypeScript errors: `npx tsc --noEmit`
- Components use existing project conventions (lucide-react icons, cn utility)
  </verify>
  <done>StopButton and ComponentSkeleton components created with fade animation CSS</done>
</task>

</tasks>

<verification>
- [ ] `npm ls sonner` shows installed
- [ ] `npx tsc --noEmit` passes (no type errors)
- [ ] StopButton.tsx exports StopButton
- [ ] ComponentSkeleton.tsx exports ComponentSkeleton
- [ ] globals.css contains component-fade-in animation
- [ ] layout.tsx contains Toaster from sonner
</verification>

<success_criteria>
1. Sonner installed and Toaster added to layout
2. StopButton component ready for use in pages
3. ComponentSkeleton component ready for use in renderers
4. Fade animation CSS available for component transitions
</success_criteria>

<output>
After completion, create `.planning/phases/05-renderer-integration/05-01-SUMMARY.md`
</output>
