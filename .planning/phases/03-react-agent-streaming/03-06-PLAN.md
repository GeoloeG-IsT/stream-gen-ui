---
phase: 03-react-agent-streaming
plan: 06
type: execute
wave: 5
depends_on: ["03-05"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "Agent streams responses token-by-token in the UI"
    - "Contact entities render as ContactCard components"
    - "Event entities render as CalendarEvent components"
    - "Multi-turn conversation maintains context"
    - "Errors display user-friendly messages"
  artifacts: []
  key_links: []
---

<objective>
End-to-end verification of the ReAct agent streaming system.

Purpose: Verify the complete integration works: frontend sends messages to backend, agent invokes RAG tool, responses stream token-by-token, and entities render correctly.

Output: Verified working system, ready for UAT
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/03-react-agent-streaming/03-CONTEXT.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Start backend and frontend servers</name>
  <files></files>
  <action>
Start both servers in background:

```bash
# Terminal 1: Backend
cd backend
source venv/bin/activate
export MISTRAL_API_KEY="your-key-here"  # User must set this
uvicorn main:app --reload --host 0.0.0.0 --port 8000

# Terminal 2: Frontend
cd frontend
npm run dev
```

Verify both are running:
- Backend: http://localhost:8000/health returns {"status":"healthy"}
- Frontend: http://localhost:3000 loads without errors
  </action>
  <verify>
curl http://localhost:8000/health
Returns: {"status":"healthy","version":"0.2.0"}

Visit http://localhost:3000/flowtoken in browser - page loads.
  </verify>
  <done>
Both servers running and healthy.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
Complete ReAct agent streaming system:
- Backend: LangGraph agent with RAG tool, streaming SSE endpoint
- Frontend: Entity parser, EntityRenderer, integrated FlowToken page
  </what-built>
  <how-to-verify>
**Setup:**
1. Ensure MISTRAL_API_KEY is set in backend/.env
2. Start backend: `cd backend && source venv/bin/activate && uvicorn main:app --reload`
3. Start frontend: `cd frontend && npm run dev`
4. Open http://localhost:3000/flowtoken

**Test 1: Basic Streaming**
- Type: "Hello, how can you help me?"
- Expected: Agent responds with streaming text (tokens appear progressively)
- Verify: Text appears word-by-word, not all at once

**Test 2: Contact Entity**
- Type: "Who works in the Parks department?"
- Expected: Agent searches knowledge base and returns contacts
- Verify: ContactCard components render (blue cards with name, email, phone)

**Test 3: Event Entity**
- Type: "What events are happening in February?"
- Expected: Agent searches and returns calendar events
- Verify: CalendarEvent components render (cards with title, date, location)

**Test 4: Mixed Entities**
- Type: "Tell me about cultural events and who organizes them"
- Expected: Mix of events and contacts in response
- Verify: Both ContactCards and CalendarEvents render in same message

**Test 5: Multi-turn Context**
- First: "Who is the director of Transportation?"
- Then: "What is their email?"
- Expected: Agent uses conversation context to answer follow-up
- Verify: Second response refers to the person from first query

**Test 6: Error Handling**
- Type: "Tell me about something not in the knowledge base"
- Expected: Agent admits it doesn't have information, suggests alternatives
- Verify: User-friendly message, no raw errors

**Report any issues:**
- Streaming not token-by-token (appears all at once)
- Entities not rendering (raw :::contact markers visible)
- CORS errors in console
- API timeouts or errors
  </how-to-verify>
  <resume-signal>Type "verified" if all tests pass, or describe specific issues</resume-signal>
</task>

</tasks>

<verification>
All 6 manual tests pass:
1. Streaming works token-by-token
2. Contact entities render as ContactCard
3. Event entities render as CalendarEvent
4. Mixed entities work in single response
5. Multi-turn context maintained
6. Errors handled gracefully
</verification>

<success_criteria>
- User confirms streaming works token-by-token
- User confirms ContactCard components render for contacts
- User confirms CalendarEvent components render for events
- User confirms multi-turn conversation maintains context
- No raw entity markers (:::contact) visible in UI
- No console errors during normal operation
</success_criteria>

<output>
After completion, create `.planning/phases/03-react-agent-streaming/03-06-SUMMARY.md`
</output>
